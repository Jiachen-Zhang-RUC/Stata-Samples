*第十三章 第5题
**1
xtset city year
/*       panel variable:  city (strongly balanced)
        time variable:  year, 80 to 90, but with gaps
                delta:  1 unit
*/
 reg lrent y90 lpop lavginc pctstu   //混合截面OLS回归
/*
      Source |       SS           df       MS      Number of obs   =       128
-------------+----------------------------------   F(4, 123)       =    190.92
       Model |  12.1080112         4  3.02700281   Prob > F        =    0.0000
    Residual |   1.9501234       123  .015854662   R-squared       =    0.8613
-------------+----------------------------------   Adj R-squared   =    0.8568
       Total |  14.0581346       127  .110693974   Root MSE        =    .12592

------------------------------------------------------------------------------
       lrent |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         y90 |   .2622267   .0347632     7.54   0.000     .1934151    .3310384
        lpop |   .0406863   .0225154     1.81   0.073    -.0038815    .0852541
     lavginc |   .5714461   .0530981    10.76   0.000     .4663417    .6765504
      pctstu |   .0050436   .0010192     4.95   0.000     .0030262     .007061
       _cons |  -.5688069   .5348808    -1.06   0.290    -1.627571    .4899568
------------------------------------------------------------------------------
*/

 reg clrent clpop clavginc cpctstu
/*
      Source |       SS           df       MS      Number of obs   =        64
-------------+----------------------------------   F(3, 60)        =      9.51
       Model |  .231738668         3  .077246223   Prob > F        =    0.0000
    Residual |  .487362198        60  .008122703   R-squared       =    0.3223
-------------+----------------------------------   Adj R-squared   =    0.2884
       Total |  .719100867        63  .011414299   Root MSE        =    .09013

------------------------------------------------------------------------------
      clrent |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       clpop |   .0722456   .0883426     0.82   0.417     -.104466    .2489571
    clavginc |   .3099605   .0664771     4.66   0.000     .1769865    .4429346
     cpctstu |   .0112033   .0041319     2.71   0.009     .0029382    .0194684
       _cons |   .3855214   .0368245    10.47   0.000     .3118615    .4591813
------------------------------------------------------------------------------
*/

 reg clrent clpop clavginc cpctstu,robust
/*
Linear regression                               Number of obs     =         64
                                                F(3, 60)          =      11.30
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3223
                                                Root MSE          =     .09013

------------------------------------------------------------------------------
             |               Robust
      clrent |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       clpop |   .0722456   .0696796     1.04   0.304    -.0671344    .2116255
    clavginc |   .3099605   .0893099     3.47   0.001     .1313141     .488607
     cpctstu |   .0112033    .002936     3.82   0.000     .0053305    .0170762
       _cons |   .3855214   .0487186     7.91   0.000     .2880697    .4829731
------------------------------------------------------------------------------
*/


*第14章第七题

 xtset id year
  /*     panel variable:  id (strongly balanced)
        time variable:  year, 87 to 93, but with gaps
                delta:  1 unit
*/

 reg mrdrte d93 exec unem if year!=87  //90 93年混合OLS回归

      Source |       SS           df       MS      Number of obs   =       102
-------------+----------------------------------   F(3, 98)        =      3.69
       Model |  1158.49706         3  386.165687   Prob > F        =    0.0144
    Residual |  10242.7183        98  104.517533   R-squared       =    0.1016
-------------+----------------------------------   Adj R-squared   =    0.0741
       Total |  11401.2153       101   112.88332   Root MSE        =    10.223

------------------------------------------------------------------------------
      mrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         d93 |  -2.067417   2.144634    -0.96   0.337    -6.323373    2.188538
        exec |   .1277287   .2632353     0.49   0.629    -.3946532    .6501105
        unem |   2.528892    .781723     3.24   0.002     .9775877    4.080196
       _cons |  -5.278005   4.427805    -1.19   0.236    -14.06484     3.50883
------------------------------------------------------------------------------
xtreg mrdrte d93 exec unem if year!=87,fe   //固定效应模型
/*
Fixed-effects (within) regression               Number of obs     =        102
Group variable: id                              Number of groups  =         51

R-sq:                                           Obs per group:
     within  = 0.1653                                         min =          2
     between = 0.0258                                         avg =        2.0
     overall = 0.0156                                         max =          2

                                                F(3,48)           =       3.17
corr(u_i, Xb)  = -0.1656                        Prob > F          =     0.0326

------------------------------------------------------------------------------
      mrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         d93 |   .4132665   .2093848     1.97   0.054    -.0077298    .8342628
        exec |  -.1038396   .0434139    -2.39   0.021    -.1911292     -.01655
        unem |  -.0665914   .1586859    -0.42   0.677    -.3856509     .252468
       _cons |   8.895029   .8606801    10.33   0.000     7.164516    10.62554
-------------+----------------------------------------------------------------
     sigma_u |  10.729333
     sigma_e |  .76289256
         rho |  .99496973   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(50, 48) = 351.02                    Prob > F = 0.0000
*/

 reg cmrdrte cexec cunem if year==93 //一阶差分模型
/*

      Source |       SS           df       MS      Number of obs   =        51
-------------+----------------------------------   F(2, 48)        =      2.96
       Model |   6.8879023         2  3.44395115   Prob > F        =    0.0614
    Residual |  55.8724857        48  1.16401012   R-squared       =    0.1097
-------------+----------------------------------   Adj R-squared   =    0.0727
       Total |   62.760388        50  1.25520776   Root MSE        =    1.0789

------------------------------------------------------------------------------
     cmrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       cexec |  -.1038396   .0434139    -2.39   0.021    -.1911292     -.01655
       cunem |  -.0665914   .1586859    -0.42   0.677    -.3856509     .252468
       _cons |   .4132665   .2093848     1.97   0.054    -.0077298    .8342628
------------------------------------------------------------------------------

*/

 xtreg mrdrte d93 exec unem if year!=87,fe robust  //异方差-稳健的固定效应
/*
Fixed-effects (within) regression               Number of obs     =        102
Group variable: id                              Number of groups  =         51

R-sq:                                           Obs per group:
     within  = 0.1653                                         min =          2
     between = 0.0258                                         avg =        2.0
     overall = 0.0156                                         max =          2

                                                F(3,50)           =      13.67
corr(u_i, Xb)  = -0.1656                        Prob > F          =     0.0000

                                    (Std. Err. adjusted for 51 clusters in id)
------------------------------------------------------------------------------
             |               Robust
      mrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         d93 |   .4132665   .1989416     2.08   0.043     .0136806    .8128524
        exec |  -.1038396   .0169091    -6.14   0.000    -.1378024   -.0698767
        unem |  -.0665914   .1461483    -0.46   0.651     -.360139    .2269561
       _cons |   8.895029   .7920595    11.23   0.000     7.304131    10.48593
-------------+----------------------------------------------------------------
     sigma_u |  10.729333
     sigma_e |  .76289256
         rho |  .99496973   (fraction of variance due to u_i)
------------------------------------------------------------------------------
*/

 reg cmrdrte cexec cunem if year==93,robust  //异方差稳健的一阶差分
/*
Linear regression                               Number of obs     =         51
                                                F(2, 48)          =      18.92
                                                Prob > F          =     0.0000
                                                R-squared         =     0.1097
                                                Root MSE          =     1.0789

------------------------------------------------------------------------------
             |               Robust
     cmrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       cexec |  -.1038396   .0169995    -6.11   0.000    -.1380194   -.0696598
       cunem |  -.0665914     .14693    -0.45   0.652    -.3620141    .2288312
       _cons |   .4132665   .2000057     2.07   0.044     .0111281    .8154049
------------------------------------------------------------------------------
*/

 gsort -cexec

 list state cexec if year==93 in 1/10
/*
     +---------------+
     | state   cexec |
     |---------------|
  1. |    TX      23 |
  2. |    VA       8 |
  4. |    AZ       3 |
  6. |    NC       2 |
  9. |    CA       2 |
     |---------------|
 10. |    OK       1 |
     +---------------+
*/

 preserve

 drop if state=="TX"  //去掉得克萨斯州
*(3 observations deleted)

 reg cmrdrte cexec cunem if year==93
/*
      Source |       SS           df       MS      Number of obs   =        50
-------------+----------------------------------   F(2, 47)        =      0.32
       Model |  .755191109         2  .377595555   Prob > F        =    0.7287
    Residual |  55.7000012        47  1.18510641   R-squared       =    0.0134
-------------+----------------------------------   Adj R-squared   =   -0.0286
       Total |  56.4551923        49  1.15214678   Root MSE        =    1.0886

------------------------------------------------------------------------------
     cmrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       cexec |   -.067471    .104913    -0.64   0.523    -.2785288    .1435868
       cunem |  -.0700316   .1603712    -0.44   0.664    -.3926569    .2525936
       _cons |   .4125226   .2112827     1.95   0.057    -.0125233    .8375686
------------------------------------------------------------------------------
*/
  reg cmrdrte cexec cunem if year==93,robust
/*
Linear regression                               Number of obs     =         50
                                                F(2, 47)          =       0.54
                                                Prob > F          =     0.5846
                                                R-squared         =     0.0134
                                                Root MSE          =     1.0886

------------------------------------------------------------------------------
             |               Robust
     cmrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       cexec |   -.067471   .0790993    -0.85   0.398    -.2265983    .0916563
       cunem |  -.0700316   .1462091    -0.48   0.634    -.3641663    .2241031
       _cons |   .4125226   .2004375     2.06   0.045     .0092943     .815751
------------------------------------------------------------------------------
*/
 restore  //回到有TX数据的地方
 
 xtreg cmrdrte cexec cunem ,fe  //三年 固定效应
/*
Fixed-effects (within) regression               Number of obs     =        102
Group variable: id                              Number of groups  =         51

R-sq:                                           Obs per group:
     within  = 0.0251                                         min =          2
     between = 0.0025                                         avg =        2.0
     overall = 0.0052                                         max =          2

                                                F(2,49)           =       0.63
corr(u_i, Xb)  = -0.0901                        Prob > F          =     0.5370

------------------------------------------------------------------------------
     cmrdrte |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       cexec |  -.1000974   .1644701    -0.61   0.546    -.4306124    .2304177
       cunem |   -.277486   .3436332    -0.81   0.423    -.9680428    .4130709
       _cons |   .8624347    .426978     2.02   0.049     .0043903    1.720479
-------------+----------------------------------------------------------------
     sigma_u |  3.0831418
     sigma_e |  4.3013866
         rho |  .33939834   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(50, 49) = 1.01                      Prob > F = 0.4843
*/
 
 
